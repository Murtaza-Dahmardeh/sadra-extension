(async function(){"use strict";function e(e,t){return CryptoJS.AES.encrypt(JSON.stringify(e),t).toString()}function t(e,t){try{const n=CryptoJS.AES.decrypt(e,t);return JSON.parse(n.toString(CryptoJS.enc.Utf8))}catch{return null}}async function n(){const e=()=>navigator.userAgent,t=()=>({width:window.screen.width,height:window.screen.height}),n=()=>screen.colorDepth,o=()=>window.devicePixelRatio||1,a=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,i=()=>navigator.language||navigator.userLanguage,r=()=>{const e=["monospace","sans-serif","serif"],t="abcdefghijklmnopqrstuvwxyz0123456789",n=document.createElement("canvas"),o=n.getContext("2d");o.font="72px monospace";const a=e.map(e=>(o.font=`72px ${e}`,o.measureText(t).width));return a},c=()=>{const e=document.createElement("canvas"),t=e.getContext("2d");return t.textBaseline="top",t.font="14px Arial",t.fillText("Hello World!",2,2),e.toDataURL()},s=()=>{const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)return null;const n=t.getExtension("WEBGL_debug_renderer_info"),o=n?t.getParameter(n.UNMASKED_VENDOR_WEBGL):"unknown",a=n?t.getParameter(n.UNMASKED_RENDERER_WEBGL):"unknown";return{vendor:o,renderer:a}},l=()=>{try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator();t.type="triangle",t.frequency.setValueAtTime(1e4,e.currentTime),t.start(0);const n=e.createAnalyser();t.connect(n);const o=new Uint8Array(n.frequencyBinCount);return n.getByteFrequencyData(o),t.stop(),Array.from(o).slice(0,10)}catch(e){return null}},d=()=>({userAgent:navigator.userAgent,platform:navigator.platform,os:navigator.oscpu||"unknown"}),u=async e=>{const t=new TextEncoder,n=t.encode(e),o=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(o)).map(e=>e.toString(16).padStart(2,"0")).join("")},m={userAgent:e(),screenResolution:t(),colorDepth:n(),deviceDPI:o(),timezone:a(),language:i(),fontsList:r(),canvasFingerprint:c(),webGLFingerprint:s(),audioFingerprint:l(),browserAndOS:d()};return u(JSON.stringify(m))}function o(e){let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e}async function a(e,t){try{const n=await i(e),o=n.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/,""),a=document.querySelector("input[name='captcha_0']").value,c=document.querySelector("input[name='captcha_1']").value;if(!a)return;const l={captchaHash:a,captchaCode:c,image:o,isUsed:!1,createdAt:Date.now()};await r(l),s(1e3*t.pre.casrt,"⏳ Reload Time",t),setTimeout(()=>{window.location.reload()},1e3*t.pre.casrt)}catch(e){return null}}function i(e){return new Promise((t,n)=>{const o=new FileReader;o.onloadend=(()=>t(o.result)),o.onerror=n,o.readAsDataURL(e)})}async function r(e){try{const t={key:e.captchaHash,value:e.captchaCode,image:e.image,isUsed:e.isUsed||!1,isCorrect:!1,createtime:e.createdAt||Date.now(),updatetime:Date.now()},n=await g("create",{key:t.key,value:t,table:"captcha"});return n.data.success?n:null}catch(e){return null}}async function c(e){if(e){const t={...e,isUsed:!0,updatetime:Date.now()};return await g("update",{key:e.key,value:t,table:"captcha"}),{captchaHash:e.key,captchaCode:e.value,image:e.image,isUsed:!0,createdAt:e.createtime}}}function s(e,t="⏳ Timer",n={pre:{isAuto:!0}}){function o(){const e=Date.now(),a=r-e;if(n.pre.isAuto)if(a>0){const e=Math.floor(a%36e5/6e4),n=Math.floor(a%6e4/1e3),r=e>0?`${e}m ${n}s`:`${n}s`;i.innerHTML=`⏳ ${r} - ${t}`,requestAnimationFrame(o)}else i.innerHTML=`✅ DONE - ${t}`,setTimeout(()=>{i.style.transition="opacity 0.5s ease",i.style.opacity="0",setTimeout(()=>i.remove(),600)},1500);else i.innerHTML=`⏸️ PAUSED - ${t}`}const a=document.getElementById("timer");a&&a.remove();const i=document.createElement("div");i.id="timer",i.textContent="⏳ Starting...",Object.assign(i.style,{position:"fixed",bottom:"0",right:"0",padding:"10px 16px",backgroundColor:"#facc15",color:"#000",fontWeight:"bold",fontSize:"14px",borderTopLeftRadius:"8px",boxShadow:"0 0 5px rgba(0,0,0,0.2)",zIndex:"9999999999"}),document.body.appendChild(i);const r=Date.now()+e;o()}function l(e,t,n){const o="wss://ivbs.sadratechs.com";let a;const i=new WebSocket(o);e.socket=i,i.onopen=(()=>{if(i.send(JSON.stringify({api_key:P})),t.className="btn btn-primary btn-w-m btn-outline",t.textContent=e.const?e.const:"🟢 Ready",e.requestQueue=[],e.isProcessing=!1,e.connected=!0,e.csrfNochecking){e.csrfNochecking=!1;let t=o("csrftoken");function o(e){const t=`; ${document.cookie}`,n=t.split(`; ${e}=`);return 2===n.length?n.pop().split(";").shift():null}setInterval(()=>{const e=o("csrftoken");e!==t&&(n.alarm&&new Audio(n.alarm).play(),document.cookie=`csrftoken=${t}; path=/; SameSite=Lax`)},5e3)}}),i.onmessage=(async t=>{if("blocked"===t.data&&(e.blocked=!0),t.data.trim().startsWith("{")){const n=JSON.parse(t.data),o=window.location.href;o.includes("confirm")?e.pre.congr===n.gr?m(n,e):"tele"===n.gr&&e.conftel&&4!==n.co.length&&7===n.link.split("/")[7].length&&J(!1).then(t=>{t&&(u(t,e,n),d(`Sended For Confirm : ${n.link.split("/")[6]} with cap ${t.captchaCode}`))}):"tele"===n.gr&&e.conftel&&m(n,e)}else{if(e.isSubmited)return;const o={46111:{agent:"461",visa:"11"},4911:{agent:"491",visa:"1"}},a=o[t.data];if(!a)return;"4911"===t.data?n.jalal&&new Audio(n.jalal).play():"46111"===t.data&&n.kabul&&new Audio(n.kabul).play();const i=document.getElementById("id_visa_type"),r=document.getElementById("id_issuer_agent"),c=document.getElementById("first_step_submit_btn");if(i&&r&&c){i.value=a.visa,r.value=a.agent,i.dispatchEvent(new Event("change")),r.dispatchEvent(new Event("change")),c.click();let t=1;const n=setInterval(()=>{t<e.pre.recn?(c.click(),t++):clearInterval(n)},e.pre.recg);e.isSubmited=!0}}}),i.onerror=(e=>{t.className="btn btn-warning btn-w-m btn-outline",t.textContent="⚠️ Error..."}),i.onclose=(o=>{e.autoRecon&&(t.className="btn btn-secondary btn-w-m btn-outline",t.textContent="🔄 Reconnecting...",clearTimeout(a),e.blocked||(a=setTimeout(()=>l(e,t,n),5e3)))})}function d(e){const t=document.getElementById("info-panel"),n=document.createElement("div");n.textContent=e,Object.assign(n.style,{marginTop:"12px",fontWeight:"bold",fontSize:"10px",color:"#1f2937"}),t.appendChild(n)}function u(e,t){const n=F(e.createdAt);n&&GM_xmlhttpRequest({method:"POST",url:G.se+"/co3we",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`,"X-Device-ID":U},data:JSON.stringify({link:t.link,cap:e.captchaHash,code:e.captchaCode,gr:"tele"})})}function m(e,t){4===e.co.length&&e.link.split("/")[7]?(t.requestQueue.push(e),p(t),d(`In List : ${e.link.split("/")[6]} with cap ${e.co}`)):t.conUser&&(t.requestQueue.push(e),p(t),d(`In User List : ${e.link.split("/")[6]}`))}function p(e){if(e.isProcessing)return;e.isProcessing=!0;const t=setInterval(async()=>{if(0===e.requestQueue.length)return e.isProcessing=!1,void clearInterval(t);const n=e.requestQueue.shift();if(e.pre.congr===n.gr){const e=document.getElementById("myInput");e.value=n.link;const t=new Event("change",{bubbles:!0});e.dispatchEvent(t),document.getElementById("id_captcha_0").value=n.cap,document.getElementById("id_captcha_1").value=n.co,document.getElementById("first_step_submit").click()}else if(4===n.co.length){const e=new FormData;e.append("csrfmiddlewaretoken",document.querySelector('input[name="csrfmiddlewaretoken"]').value),e.append("activation_key",n.link.split("/")[7]),e.append("captcha_0",n.cap),e.append("captcha_1",n.co);const t=await fetch(n.link,{method:"POST",body:e});let o=await t.text();const a=window.open();a.document.open(),a.document.write(o),a.history.pushState({},"",n.link),a.document.close()}else GM_xmlhttpRequest({method:"GET",url:n.link,onload:function(e){let t=e.responseText;const o=window.open();o.document.open(),o.document.write(t),o.history.pushState({},"",n.link),o.document.close()}})},e.pre.qwt)}function g(e,{key:t,value:n,table:o="forms"}={}){return new Promise(a=>{function i(e){window.removeEventListener("extension-db-response",i),a(e.detail)}window.addEventListener("extension-db-response",i),window.dispatchEvent(new CustomEvent("extension-db-request",{detail:{op:e,key:t,value:n,table:o}}))})}async function f(e="forms"){const t=await g("list",{table:e});return t.data.success?t.data.value:[]}async function h(e,t,n="forms"){return await g("update",{key:e,value:t,table:n})}async function y(e,t="forms"){return await g("delete",{key:e,table:t})}function b(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=(()=>{const e=o.result;t(e)}),o.onerror=n,o.readAsDataURL(e)})}function _(e){return new Promise((t,n)=>{try{const o=e.replace(/^data:[^;]+;base64,/,""),a=atob(o),i=new Array(a.length);for(let e=0;e<a.length;e++)i[e]=a.charCodeAt(e);const r=new Uint8Array(i);let c="image/png";e.startsWith("data:image/jpeg")?c="image/jpeg":e.startsWith("data:image/png")?c="image/png":e.startsWith("data:image/gif")?c="image/gif":e.startsWith("data:image/webp")&&(c="image/webp");const s=new Blob([r],{type:c});t(s)}catch(e){n(e)}})}async function w(e,t,n="upload.png"){if(!e||"INPUT"!==e.tagName||"file"!==e.type)return;const o=new File([t],n,{type:t.type}),a=new DataTransfer;a.items.add(o),e.files=a.files;const i=new Event("change",{bubbles:!0});e.dispatchEvent(i)}async function v(e){const t=e=>document.querySelector(e).value||"",n={key:e.filpid||Date.now().toString(),name:t("#id_first_name"),lastname:t("#id_last_name"),fathername:t("#id_father_name"),gender:t("#id_gender"),birth:t("#id_birth_date"),passport:t("#id_passport_number"),issue:t("#id_passport_issue_date"),expire:t("#id_expire_date"),job:t("#id_job"),mobile:t("#id_mobile"),iranPhone:t("#id_iran_phone_number"),address:t("#id_residence_address"),iranAddress:t("#id_iran_address"),duration:t("#id_duration"),entry:t("#id_entry_option"),purpose:t("#id_extra_741"),arrival:t("#id_extra_751"),departure:t("#id_extra_761"),order:0,isAuto:!1,isKabul:!1,isJalal:!1,createtime:Date.now(),updatetime:Date.now()},o=document.getElementById("id_picture");if(o&&o.files.length>0)try{n.photo=await b(o.files[0])}catch(e){console.error(e)}const a=document.getElementById("id_passport_image");if(a&&a.files.length>0)try{n.pass=await b(a.files[0])}catch(e){console.error(e)}const i=document.getElementById("id_extra_country_2231");if(i&&i.files.length>0)try{n.tsf=await b(i.files[0])}catch(e){console.error(e)}const r=document.getElementById("id_extra_1541");if(r&&r.files.length>0)try{n.tsb=await b(r.files[0])}catch(e){console.error(e)}const c=document.getElementById("id_extra_country_2141");if(c&&c.files.length>0)try{n.update=await b(c.files[0])}catch(e){console.error(e)}await h(n.key,n),e.filpid=n.key}async function x(e,t){const n=e;if(!n)return;const o=(e,t,n=!1)=>{const o=document.querySelector(e);o&&(o.value=t,n&&o.dispatchEvent(new Event("change")))},a=[["#id_first_name",n.name],["#id_last_name",n.lastname],["#id_father_name",n.fathername],["#id_birth_date",n.birth],["#id_passport_number",n.passport],["#id_passport_issue_date",n.issue],["#id_expire_date",n.expire],["#id_job",n.job],["#id_phone_number",n.mobile],["#id_mobile",n.mobile],["#id_residence_address",n.address],["#id_iran_phone_number",n.iranPhone],["#id_iran_address",n.iranAddress],["#id_extra_741",n.purpose],["#id_extra_751",n.arrival],["#id_extra_761",n.departure]];a.forEach(([e,t])=>o(e,t)),o("#id_gender",n.gender,!0),o("#id_duration",n.duration,!0),o("#id_entry_option",n.entry,!0),t.filpid=n.key;const i=async(e,t,n)=>{if(e)try{const o=document.querySelector(t);if(o&&"file"===o.type){const t=await _(e,n);await w(o,t,n)}}catch(e){console.error(e)}};await Promise.all([i(n.photo,"#id_picture","photo.jpeg"),i(n.pass,"#id_passport_image","passport.jpeg"),i(n.tsf,"#id_extra_country_2231","tsf.jpeg"),i(n.tsb,"#id_extra_1541","tsb.jpeg"),i(n.update,"#id_extra_country_2141","update.jpeg")])}async function S(e){e.filpid&&await y(e.filpid)}async function E(e,t){const n=await f(),o=await n.sort((e,t)=>e.order-t.order),a=document.getElementById("inSlider");a&&o.forEach(t=>{const n=document.createElement("button");n.textContent=t.name,n.className="btn btn-light btn-sm",n.style.margin="5px",n.onclick=(()=>x(t,e)),a.parentNode.insertBefore(n,a.nextSibling)});var i=o.filter(e=>!0===e.isAuto);if(i.length>0)for(const n of i){let o=!1;var r=localStorage.getItem("pr");if(r=JSON.parse(r),!r.includes(n.name)&&("46111"===t&&n.isKabul?(x(n,e),o=!0):"4911"===t&&n.isJalal?(x(n,e),o=!0):"46111"!=t&&"4911"!=t&&(n.isKabul||n.isJalal||(x(n,e),o=!0)),o)){r.push(n.name),localStorage.setItem("pr",JSON.stringify(r)),await C(e,null,!0);const t=document.getElementById("id_captcha_1").value;t.length>3&&(setTimeout(()=>{document.getElementById("second_step_submit_btn").click()},1e3),setTimeout(()=>{document.getElementById("final-form-submit").click()},2e3));break}}}function k({triggerSelector:e,insertBefore:t,clickCount:n=5,clickInterval:o=500}){const a=document.querySelector(e),i=document.querySelector(t);if(!a)return;const r=document.createElement("button");r.textContent="🔥 Shoot",r.className="btn btn-danger btn-w-m btn-outline",r.style="margin: 10px;",r.id="go",i.parentNode.insertBefore(r,i),r.addEventListener("click",()=>{let e=1;a&&a.click();const t=setInterval(()=>{e<n?(a&&a.click(),e++):clearInterval(t)},o)})}function I(e,t,n){async function o(){const o=document.getElementById("register_form");if(!o)return;const a=new FormData(o),i=window.location.href.includes("confirm")&&document.getElementById("myInput").value||t,r=document.getElementById("try");r.textContent=`${++s} Sent`;try{const t=await fetch(i,{method:"POST",body:a}),o=`\n<script>\n(async function() {\n    try {\n        const res = await fetch('https://ivbs.sadratechs.com/script.js');\n        const script = await res.text();\n        const el = document.createElement('script');\n        el.textContent = script;\n        window.gfp = "${e.pre.fp}";\n        document.head.appendChild(el);\n    } catch (e) {\n    }\n})();\n</script>`;if(t.url.includes("confirm")&&"final-form-submit"===n){c.textContent="Got Link",d(t.url),clearInterval(e.subint),e.submitting=!1,new Notification("New Link",{body:"Check ME"});let n=await t.text();n+=o;const a=window.open();return a.document.open(),a.history.pushState({},"",t.url),a.document.write(n),a.document.close(),void window.stop()}if(200===t.status){let e=await t.text();if(e+=o,e.includes("error-section--waiting"))d("Robot");else{const n=window.open();n.document.open(),n.history.pushState({},"",t.url),n.document.write(e),n.document.close(),d("Success")}}else d(`Recived : ${t.status}`)}catch(e){console.log(e)}}function a(){const t=document.getElementById(n);t&&t.click(),e.submitting=!0,e.keepsubmit="started",s=0,e.subint=setInterval(o,e.pre.fsbint)}function i(){clearInterval(e.subint),e.submitting=!1,e.keepsubmit="stoped",c.textContent="Restart",window.stop()}function r(){e.keepsubmit="started",e.submitting=!0,c.textContent="Stop",s=0,e.subint=setInterval(o,e.pre.fsbint)}const c=document.createElement("button");if(c.id="start",c.textContent="Start Now",c.className="btn btn-warning btn-w-m btn-outline",c.style.margin="10px","final-form-submit"===n){const e=document.getElementById("final-form-submit");e.parentNode.insertBefore(c,e.nextSibling)}else{if(!e.pre.fabt)return;const t=document.getElementById("fire");if(!t)return;t.parentNode.insertBefore(c,t.nextSibling)}let s=0;c.onclick=(()=>{const t=e.keepsubmit;A(),"started"===t?i():"stoped"===t?r():(c.textContent="Stop",a())})}async function C(e,t){await J(t).then(t=>{t&&B(t,e)}).catch(e=>{console.error(e)})}function B(e,t){const n=F(e.createdAt),o=document.querySelector("#id_captcha_0"),a=document.querySelector("#id_captcha_1"),i=document.querySelector(".ecaptcha"),r=document.getElementById("fire");if(o&&a&&i)if(n){o.value=e.captchaHash,a.value=e.captchaCode;const n=new Image;n.src="data:image/png;base64,"+e.image,n.className="ecaptcha",i.parentNode.replaceChild(n,i),r&&t&&(t.className="fa fa-thumbs-up",window.stop())}else r&&t&&(t.className="fa fa-exclamation-triangle")}function A(){const e=document.querySelector("#info-panel");if(e)return;const t=document.createElement("div");t.id="info-panel",Object.assign(t.style,{position:"fixed",top:"0",left:"0",height:"50vh",width:"200px",padding:"16px",backgroundColor:"#f3f4f6",color:"#111827",borderRight:"1px solid #d1d5db",boxShadow:"2px 0 5px rgba(0,0,0,0.05)",zIndex:"9999999999",overflowY:"auto",maxHeight:"90vh"}),document.body.appendChild(t);const n=document.createElement("div");n.id="cont-panel",t.appendChild(n);const o=document.createElement("span");o.id="try",o.textContent="Tried : 0",o.style.fontWeight="bold",o.style.textAlign="center",o.style.display="block",o.style.padding="5px",n.appendChild(o)}function T(e,t,n,o){if(document.getElementById("fire"))return;const a=document.createElement("button");a.id="fire",a.textContent="Manual",a.className="btn btn-success btn-w-m btn-outline",a.style="margin:10px;",e.parentNode.insertBefore(a,e.nextSibling),a.onclick=(()=>{const i=t.pre.isAuto;if(i){if(t.pre.isAuto=!1,"confirm"===n&&t.pre.hlc){const t=document.createElement("input");t.type="text",t.id="myInput",t.className="form-control",t.style="margin:10px;width:500px",t.onchange=(()=>{const e=t.value,n=e.split("/")[7]||"";document.getElementById("register_form").action=e,document.getElementById("id_activation_key").value=n}),e.parentNode.insertBefore(t,a.nextSibling)}"first"===n?(a.textContent="Start Waiting",window.stop()):"confirm"===n&&(a.textContent="Start Confirming",window.stop())}else if(t.connected)t.socket.close(),t.autoRecon=!1,t.connected=!1,a.textContent="Disconnected";else{if(t.pre.telconf){A();const e=document.querySelector("#cont-panel"),n=document.createElement("input");n.type="checkbox",n.id="confirm-Tel",Object.assign(n.style,{width:"18px",height:"18px",marginRight:"8px",verticalAlign:"middle",cursor:"pointer"});const o=document.createElement("label");o.htmlFor="confirm-Tel",o.innerText="Confirm Telegram",Object.assign(o.style,{marginRight:"15px",fontSize:"12px",cursor:"pointer",userSelect:"none"}),e.appendChild(n),e.appendChild(o),n.addEventListener("change",()=>{t.conftel=n.checked});const a=document.createElement("input");a.type="checkbox",a.id="confirm-user",Object.assign(a.style,{width:"18px",height:"18px",marginRight:"8px",verticalAlign:"middle",cursor:"pointer"});const i=document.createElement("label");i.htmlFor="confirm-user",i.innerText="Confirm With User",Object.assign(i.style,{marginRight:"15px",fontSize:"12px",cursor:"pointer",userSelect:"none"}),e.appendChild(a),e.appendChild(i),a.addEventListener("change",()=>{t.conUser=a.checked})}t.autoRecon=!0,l(t,a,o)}})}async function q(e,t){const n=!!document.querySelector("#id_track_code");if(n&&(t.pre.isAuto=!0,s(1e3*t.pre.cassw,"⏳ Solve Time",t),setTimeout(()=>{a(e,t)},1e3*t.pre.cassw)),!t.pre.sch||t.isSolved||t.solving)return;t.solving=!0;const o=new FormData;o.append("image",e,"image.png"),o.append("fp",t.pre.fp),GM_xmlhttpRequest({method:"POST",url:G.se+"/g2cd",headers:{Authorization:`Bearer ${P}`,"X-Device-ID":U},data:o,onload:function(e){t.solving=!1;try{const n=JSON.parse(e.responseText),o=n.code,a=document.querySelector("#id_captcha_1");a&&o&&(a.value=o,o.length>=4&&(t.isSolved=!0))}catch(e){console.log(e)}},onerror:function(){t.solving=!1}});const i=new FileReader;i.onloadend=function(){const e=i.result,t=document.querySelector(".ecaptcha");if(!t)return;const n=new Image;n.src=e,n.className="ecaptcha",t.parentNode.replaceChild(n,t)},i.readAsDataURL(e)}async function N(e){const t=document.querySelector(".ecaptcha");if(!t)return;const n=document.createElement("canvas");n.width=t.naturalWidth,n.height=t.naturalHeight;const o=n.getContext("2d");o.drawImage(t,0,0),n.toBlob(async n=>{if(n)e.capok=!0,await q(n,e);else{const n=t.getAttribute("src");if(n&&n.includes("ecaptcha"))try{const t=await fetch(`https://evisatraveller.mfa.ir${n}`);if(t.ok&&"image/png"===t.headers.get("content-type")){const n=await t.arrayBuffer(),o=new Blob([n],{type:"image/png"});e.capok=!0,await q(o,e),window.stop()}}catch(e){console.log(e)}}},"image/png")}function D(e,t){e.setAttribute("target","_blank"),t.pre.isAuto=!0;const n="first_step_submit",o=document.getElementById(n);T(e,t,"confirm");const a=document.getElementById("fire");if(I(t,"conf",n),setInterval(()=>{const e=document.getElementById(n);e&&(e.disabled=!1)},3e3),!o||!a)return;t.pre.issh&&k({triggerSelector:"#first_step_submit",insertBefore:"#fire",buttonId:"go",buttonText:"🔥 Shoot",clickCount:t.pre.cnsin,clickInterval:t.pre.cnsig});const i=document.createElement("button");i.id="cost",i.textContent="Send To All",i.className="btn btn-info btn-w-m btn-outline",i.style.margin="10px",a.insertAdjacentElement("afterend",i),i.addEventListener("click",()=>{i.disabled=!0,setTimeout(()=>{i.disabled=!1},1e4),GM_xmlhttpRequest({method:"POST",url:G.se+"/co3we",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`,"X-Device-ID":U},data:JSON.stringify({link:document.getElementById("myInput").value,cap:document.getElementById("id_captcha_0").value,code:document.getElementById("id_captcha_1").value,gr:t.pre.congr})})})}function $(e,t,n){const o=document.getElementById("id_email"),a=document.getElementById("id_captcha_0"),i=document.getElementById("final-form-submit");if(t.setAttribute("target","_blank"),!o||!a||!i)return;setInterval(()=>{o.value=e.pre.email},2e3),setInterval(()=>{i.disabled=!1},3e3),a.addEventListener("paste",e=>{a.value=e.clipboardData.getData("text"),e.preventDefault()}),e.pre.issh&&k({triggerSelector:"#final-form-submit",insertBefore:"#final-form-submit",buttonId:"go",buttonText:"🔥 Shoot",clickCount:e.pre.snfps,clickInterval:e.pre.snfpsg}),I(e,"https://evisatraveller.mfa.ir/en/request/applyrequest/#","final-form-submit");const r=async()=>{const t=document.getElementById("inSlider");if(t){const o=document.createElement("button");o.textContent="Save & Update",o.className="btn btn-info btn-sm",o.style.margin="5px",o.onclick=(()=>v(e)),t.parentNode.insertBefore(o,t.nextSibling);const a=document.createElement("button");a.textContent="Delete",a.className="btn btn-info btn-sm",a.style.margin="5px",a.onclick=(()=>S(e)),t.parentNode.insertBefore(a,t.nextSibling),await E(e,n)}};r()}function R(e,t,n){t.pre.isAuto=!0,e.setAttribute("target","_blank"),s(1e3*t.pre.smawt,"⏳ Submit Time",t),t.csrfNochecking=!0,n.outofcapacity&&new Audio(n.outofcapacity).play(),setTimeout(()=>{const e=document.querySelector("#first_step_submit_btn");e&&t.pre.isAuto&&(e.click(),t.pre.smact>0&&(s(1e3*t.pre.smact,"⏳ To Close Tab",t),setTimeout(()=>{t.pre.isAuto&&window.close()},1e3*t.pre.smact)))},1e3*t.pre.smawt);const o=document.getElementById("id_issuer_agent");if(o){const e=Array.from(o.options).map(e=>e.value);if(!e.includes("461")){const e=new Option("KABUL","461"),t=new Option("JALAL ABAD","491");o.add(e),o.add(t)}const t=(e,t,n=!1)=>{const o=document.querySelector(e);o&&(o.value=t,n&&o.dispatchEvent(new Event("change")))},n=document.getElementById("inSlider"),a=[{agn:"Kabul",type:"11",co:"461"},{agn:"Jalal",type:"1",co:"491"}];for(const e of a){const o=document.createElement("button");o.textContent=e.agn,o.className="btn btn-info btn-sm",o.style.margin="5px",o.onclick=(()=>{t("#id_visa_type",e.type,!0),t("#id_nationality","21",!0),t("#id_passport_type","1",!0),t("#id_issuer_agent",e.co,!0)}),n.parentNode.insertBefore(o,n.nextSibling)}const i=document.createElement("button");i.textContent="Reset",i.className="btn btn-danger btn-sm",i.style.margin="5px",i.onclick=(()=>{localStorage.setItem("pr","[]")}),n.parentNode.insertBefore(i,n.nextSibling)}T(e,t,"first",n),t.pre.issh&&k({triggerSelector:"#first_step_submit_btn",insertBefore:"#fire",buttonId:"go",buttonText:"🔥 Shoot",clickCount:t.pre.shsin,clickInterval:t.pre.shsig}),I(t,"https://evisatraveller.mfa.ir/en/request/applyrequest/","first_step_submit_btn")}function L(e,t,n,o){const a=!!document.querySelector("#id_first_name"),i=!!document.querySelector("#id_activation_key"),r=!!document.querySelector("#id_visa_type"),c=document.querySelector(".ecaptcha");if(c){var s=document.createElement("a");s.href="https://evisatraveller.mfa.ir"+c.getAttribute("src"),s.target="_blank",s.textContent=" OPEN",c.parentNode.insertBefore(s,c.nextSibling);var l=document.createElement("a");l.href="#void",c.parentNode.insertBefore(l,c.nextSibling);const t=document.createElement("i");t.className="fa fa-image",t.style.margin="10px",l.appendChild(t),l.addEventListener("click",function(){C(e,t)});var d=document.querySelector("#id_captcha_0");d.type="text";const n=setInterval(()=>{e.capok?clearInterval(n):N(e)},e.pre.gcit)}a?(I(e),$(e,n,o)):i?(t.outofcapacity&&new Audio(t.newLink).play(),D(n,e,t)):r&&R(n,e,t)}function O(e){const t=JSON.parse(GM_getResourceText("sounds")||"{}"),n=document.querySelector("#register_form"),a=document.querySelector("#id_first_name"),i=window.location.href;var r="";if(a){const n=document.getElementById("id_visa_type"),a=document.getElementById("id_issuer_agent_id"),i=n.options[n.selectedIndex].value||"",c=a.value||"";r=c+i,t.submitrequest&&new Audio(t.submitrequest).play();const s=document.querySelector(".alert-dismissable"),l=document.querySelector(".modal-title"),d="46111"===r||"4911"===r?"green":"red";s&&(s.style.backgroundColor=d),l&&(l.style.backgroundColor=d),GM_xmlhttpRequest({method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`,"X-Device-ID":U},url:`${G.se}/repo?ste=SecondStep&ag=${c}&vt=${i}&user=${e.user}`}),o("https://img.icons8.com/?size=16&id=nU3xgaV2IKwS&format=png&color=000000?v=temporary")}else if(i.includes("confirm")){const t=i.split("/"),n=`${t[6]||""}|${t[7]||""}`;GM_xmlhttpRequest({method:"GET",url:`${G.se}/repo?state=Confirm&user=${e.user}&info=${n}`}),o("https://img.icons8.com/?size=16&id=DFU1kReSUccu&format=png&color=000000?v=temporary")}if(n)L(e,t,n,r);else if(i.includes("ecaptcha"))setTimeout(()=>{const e=document.querySelector(`img[src="${i}"]`),t=document.querySelector(".error-section--waiting");e||t||window.location.reload()},1e3);else{const t=document.querySelector("#printable-area"),n=document.querySelector("#go_to_track");if(t||n){const t=i.split("confirm")[1]||"";GM_xmlhttpRequest({method:"GET",url:`${G.se}/repo?ste=Success&info=${t}&user=${e.user}`})}else{const t=document.querySelector(".error-section--waiting");t||setTimeout(()=>{e.user&&e.pre.autrl&&window.location.reload()},500)}}}async function j(t,n,o){GM_xmlhttpRequest({method:"GET",url:`${G.se}/veiwp32m?fp=${t}&lat=${n}&lot=${o}`,headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`,"X-Device-ID":U},onload:n=>{let o;try{o=JSON.parse(n.responseText)}catch(e){console.log(e)}switch(o.status){case"wqdfe321#21":o.timestamp=(new Date).toISOString(),o.pre.fp=t;var a=e(o,M);localStorage.setItem("log",a),O(o);break;case"expsin!15":alert(o.message),document.body.innerHTML="";break;default:alert("Connection Error"),document.body.innerHTML=""}}})}const U=await GM_getExtensionValue("__cat_bg_color"),P=await GM_getExtensionValue("__cat_api_key"),M=U+"b"+P,G={se:"https://ivbs.sadratechs.com"},J=async e=>{try{const t=await g("list",{table:"captcha"});if(t.data.success&&t.data.value&&t.data.value.length>0){const n=t.data.value.filter(e=>!e.isUsed);if(n.length>0){const t=n.sort((e,t)=>t.createtime-e.createtime);return c(e?t.filter(e=>e.isCorrect)[0]:t[0])}}return null}catch(e){return null}},F=e=>{const t=new Date(e);return Date.now()-t.getTime()<=36e5};n().then(e=>{const n=localStorage.getItem("log");if(navigator.geolocation)if(n){const o=t(n,M),a=new Date(o.timestamp),i=new Date,r=(i-a)/6e4;o.pre.fp===e&&r<20?O(o):navigator.geolocation.getCurrentPosition(t=>{j(e,t.coords.latitude,t.coords.longitude)})}else navigator.geolocation.getCurrentPosition(t=>{j(e,t.coords.latitude,t.coords.longitude)});else console.log("Please turn on the location")})})();